{% extends 'base.html' %}
{% block content %}
<h2>Production</h2>
<form method="get" action="/production" class="scan-form">
  <label>Scan QR OR type pallet</label>
  <input name="q" value="{{query}}" placeholder="P-10452 or pallet id" autofocus />
  <button type="submit">Find</button>
</form>

{% if found %}
<div class="card">
  <div class="label">Pallet found</div>
  <a href="/production/pallet/{{found.id}}" class="action-btn">Open {{found.pallet_code}}</a>
</div>
{% elif query %}
<div class="form-error-banner">No pallet found for "{{query}}". Check scan quality or code format.</div>
{% endif %}

<h3>Create Manual Pallet (Supervisor)</h3>
<form method="post" action="/production/create-pallet" class="panel-form">
  <label>Part revision</label>
  <select name="part_revision_id" required>
    <option value="">-- select revision --</option>
    {% for p in part_revisions %}
      <option value="{{p.id}}">{{p.id}} â€” Rev {{p.revision_code}}</option>
    {% endfor %}
  </select>
  <label>Quantity</label>
  <input name="quantity" type="number" step="0.01" min="0.01" required />
  <label>Start station</label>
  <select name="location_station_id">
    <option value="">-- staged / no station --</option>
    {% for st in stations %}
      <option value="{{st.id}}">{{st.station_name}}</option>
    {% endfor %}
  </select>
  <button type="submit">Create + Print traveler</button>
</form>

<h3>Next Pallets</h3>
<div class="grid-list">
  {% for p in next_pallets %}
    <a class="quick-pallet" href="/production/pallet/{{p.id}}">
      <strong>{{p.pallet_code}}</strong>
      <span>Status: {{p.status}}</span>
    </a>
  {% endfor %}
</div>
{% endblock %}
